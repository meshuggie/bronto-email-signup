!function(e){"use strict";function r(e,r){r?(e.addClass("disabled"),e.find("fieldset").prop("disabled"),e.find(".loading").removeClass("hidden")):(e.removeClass("disabled"),e.find("fieldset").removeAttr("disabled"),e.find(".loading").addClass("hidden"))}e(window).on("load",function(){e(".bronto-email-signup").each(function(){r(e(this),!1);var s=e(this).validate({errorPlacement:function(e,r){e.appendTo(r.parents(".form-group"))}}),n=e(this).find('input[name="mobileNumber"]'),a=e(this).find('input[name="email"]');n.length?n.rules("add",{required:!0,number:!0}):a.rules("add",{required:!0,email:!0});var i=e(this).find('[aria-required="true"]:not(span)').map(function(){return e(this)}).get();i.forEach(function(e){e.rules("add",{required:!0})}),e(this).on("submit",function(n){if(n.preventDefault(),!s.form())return!1;var a=e(this);r(a,!0);var i=e(this).serializeArray().reduce(function(e,r){return e[r.name]=r.value,e},{});i.action="broes_add_contact",i._ajax_nonce=broes.nonce,i.expected_inputs=broes.expected_inputs,e.post(broes.ajax_url,i,function(e){var s,n=e.result,i=""!==e.webformUrl?'<br><a href="'+e.webformUrl+'" target="_blank">Manage your Preferences</a>':"",t=new CustomEvent("brontoSignup",{detail:{response:n},bubbles:!0,cancelable:!0});if(a[0].dispatchEvent(t),r(a,!1),"error"==e.result){var o=""!==broes.registered_message?broes.registered_message:e.message;s='<p class="error">',s+=o,s+=i,s+="</p>"}else{var o=""!==broes.success_message?broes.success_message:e.message;s='<p class="success">',s+=o,s+="updated"==e.result?i:"",s+="</p>"}a.find(".response").html(s)},"json")})})})}(jQuery);